\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{booktabs}
\usepackage{dcolumn} % Booktabs column spacing
\usepackage{threeparttable} % Align column caption, table, and notes
\usepackage{adjustbox} % Shrink boxes
\usepackage{float}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Heart Disease Prediction}

\author{\IEEEauthorblockN{Xavier Santos}
    \IEEEauthorblockA{\textit{Departamento de Eletrónica, Telecomunicações e Informática} \\
        \textit{Universidade de Aveiro}\\
        Aveiro, Portugal \\
        xavier@ua.pt}
}

\maketitle

\begin{abstract}
    This project aims to find the most efficient model to predict the presence of a heart disease on a patient based on 14 preconditions and exam results from a single hospital and then test the trained models against data from hospitals in different hospitals and countries.
\end{abstract}

\begin{IEEEkeywords}
    machine learning, dataset, heart disease, prediction, logistic regression, naive Bayes, k nearest neighbors, decision tree, random forest
\end{IEEEkeywords}

\section{Introduction}
In this study, it was analyzed the data form the UCI Machine Learning Repository\cite{b5} regarding patient data used to ascertain the presence of a heart disease. In order to predict said disease were used five models of prediction: Logistic Regression, Naive Bayes, K Nearest Neighbors, Decision Tree and Random Forest.

\section{Dataset}
This dataset used for training contains the data of 303 patients from Cleveland\cite{b4} described by 14 attributes each; 5 of which are numerical values while the other 9 represent categories. The "goal" field is represented by a binary value representing the presence or absence of heart disease in the patient. There were other 3 other datasets from Hungary\cite{b1}, Switzerland\cite{b2,b3} and Long Beach\cite{b4} in which the models obtained from the first set were tested after the training. Most of these datasets, however, had many missing values.\\
The features used are age, sex, chest pain type, resting blood pressure, cholesterol, fasting blood sugar, resting electrocardiogram, maximum heart rate, exercise induced angina, ST depression, ST slope, number of major vessels and Thallium stress test results. An example of the data is show in Table \ref{tab1}.

\begin{table}[htbp]
    \caption{Data head}
    \begin{center}
        \resizebox{\columnwidth}{!}{%
            \input{tables/data_head.tex}
        }%
        \label{tab1}
    \end{center}
\end{table}

\section{Data analysis}

The contents of Table \ref{tab2} show some relevant statistics about the data that is being used for training.

\begin{table}[htbp]
    \caption{Data description}
    \begin{center}
        \resizebox{\columnwidth}{!}{%
            \input{tables/data_describe.tex}
        }%
        \label{tab2}
    \end{center}
\end{table}

Continuing the analysis, it was verified that some features have more impact on the patient's diagnosis than others. For instance, if a patient has or not exercise induced angina, this is a much stronger indicator of a heart disease than his number of major vessels or fasting blood sugar value as it can be seen in Table \ref{tab3} and Figure \ref{fig1}.

\begin{table}[htbp]
    \caption{Data correlation}
    \begin{center}
        \input{tables/data_correlation.tex}
        \label{tab3}
    \end{center}
\end{table}

\begin{figure}[H]
    \centerline{\includegraphics[width=0.8\linewidth]{images/correlation_scatter.pdf}}
    \caption{Scatter plots of the correlation between the features and the diagnosis}
    \label{fig1}
\end{figure}

From the gathered data it can also be concluded that the percentage of patience without heart problems in this sample is 54.13\%.

\begin{figure}[htbp]
    \centerline{\includegraphics[width=0.7\linewidth]{images/percentage_general.pdf}}
    \caption{Distribution of heart disease in patients}
    \label{fig2}
\end{figure}

\section{Data Preprocessing}

Before training the models the data had to be prepared by filling the missing values on some of the features. This was achieved by giving the mean value for that feature if it was a numeric value or the most common value if it was categorical.\\
The data was then shuffled and split in two sets: one for training and another one for testing and cross-validation with the distribution of 80\% and 20\% respectively.

\section{Model training and tuning}

\subsection{Logistic Regression}

\subsection{Naive Bayes}

\subsection{K Nearest Neighbors}

\subsection{Decision Tree}

\subsection{Random Forest}

\section{Results}

\section{Conclusion}

\begin{thebibliography}{00}
    \bibitem{b1} Hungarian Institute of Cardiology. Budapest: Andras Janosi, M.D.
    \bibitem{b2} University Hospital, Zurich, Switzerland: William Steinbrunn, M.D.
    \bibitem{b3} University Hospital, Basel, Switzerland: Matthias Pfisterer, M.D.
    \bibitem{b4} V.A. Medical Center, Long Beach and Cleveland Clinic Foundation:Robert Detrano, M.D., Ph.D.
    \bibitem{b5} Dua, D. and Graff, C. (2019). UCI Machine Learning Repository [http://archive.ics.uci.edu/ml]. Irvine, CA: University of California, School of Information and Computer Science.
\end{thebibliography}

\end{document}
